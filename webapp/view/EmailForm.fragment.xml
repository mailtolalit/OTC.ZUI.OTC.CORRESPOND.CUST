<!--

    Copyright (C) 2009-2022 SAP SE or an SAP affiliate company. All rights reserved.

-->
<core:FragmentDefinition
		xmlns:f="sap.ui.layout.form"
		xmlns="sap.m"
		xmlns:core="sap.ui.core"
>
	<core:InvisibleText
			id="idLabelEmailForm"
			text="{i18n>EMAIL_FORM_INVISIBLE_LABLE}"
	/>
	<f:SimpleForm
			id="idMailForm"
			class="sapUiForceWidthAuto"
			editable="true"
			layout="ResponsiveGridLayout"
			breakpointM="750"
			labelSpanM="12"
			labelSpanL="12"
			emptySpanM="5"
			emptySpanL="7"
			ariaLabelledBy="idLabelEmailForm"
			busy="{corrItems>Email/EmailBusy}"
	>
		<f:content>
			<Label
					id="idLabelEmailSender"
					text="{/#Email/SenderAddress/@sap:label}"
					labelFor="idEmailSender"
			/>
			<Input
					id="idEmailSender"
					value="{corrItems>Email/SenderAddress}"
					editable="false"
			/>
			<Label
					id="idLabelEmailTo"
					text="{/#Email/To/@sap:label}"
					labelFor="idEmailto"
					required="true"/>
			<MultiInput
					id="idEmailto"
					change="onEmailtoChange"
					liveChange="onEmailtoLiveChange"
					tokenUpdate="onEmailTokenChange"
					enableMultiLineMode="true"
					valueHelpRequest="onEmailValueHelpRequest"
					showValueHelp="true"
					tokens="{corrItems>Email/Emails}"
					value="{corrItems>Email/EmailTo}"
					valueState="{corrItems>Email/EmailToState}"
					valueStateText="{corrItems>Email/EmailToStateText}"
			>
				<tokens>
					<Token
							id="idTokenEmailto"
							key="{corrItems>email}"
							text="{corrItems>email}"
					/>
				</tokens>
			</MultiInput>
			<Label
					text="{/#Email/MailTemplateId/@sap:label}"
					labelFor="idEmailTemplate"
					id="idLabelEmailTemplateComboBox"
			/>
			<ComboBox
					id="idEmailTemplate"
					selectionChange="onTemplateChanged"
					ariaLabelledBy="idLabelEmailTemplateComboBox"
					placeholder="{i18n>NO_TEMPLATE}"
					visible="{corrItems>Email/EmailTemplateVisible}"
					items="{path:'corrItems>Email/Templates'}"
					selectedKey="{corrItems>Email/TemplateKey}"
					value="{corrItems>Email/Template}"
					valueState="{corrItems>Email/TemplateState}"
					valueStateText="{corrItems>Email/TemplateStateText}"
					required="true"
					busy="{corrItems>Email/TemplateBusy}"
			>
				<core:ListItem
						id="idEmailTemplateListItem"
						key="{corrItems>MailTemplateId}"
						text="{corrItems>Name}"
				/>
			</ComboBox>
			<Label
					id="idLabelEmailSubject"
					text="{/#Email/Subject/@sap:label}"
					labelFor="idEmailSubject"
			/>
			<Input
					value="{corrItems>Email/EmailSubject}"
					change="onSubjectChanged"
					id="idEmailSubject"
					maxLength="{path: '/#Email/Subject/@maxLength', formatter:'parseInt'}"
			/>
			<Label
					text="{/#Email/Content/@sap:label}"
					id="idLabelEmailContent"
			/>
			<TextArea
					id="idEmailContent"
					rows="5"
					ariaLabelledBy="idLabelEmailContent"
					value="{corrItems>Email/EmailContent}"
					visible="{corrItems>Email/EmailContentVisible}"
			/>
			<Label
					id="idLabelTemplateContent"
					text="{i18n>TEMPLATE_PREVIEW_TITLE}"
					labelFor="idEmailTemplateContent"
					visible="{corrItems>Email/TemplateContentVisible}"
			/>
			<ScrollContainer
					id="idEmailTemplateContent"
					vertical="true"
					visible="{corrItems>Email/TemplateContentVisible}"
			>
				<core:HTML
						id="idEmailTemplateHtmlContent"
						sanitizeContent="true"
						content="{corrItems>Email/HtmlContent}"
				/>
			</ScrollContainer>
		</f:content>
	</f:SimpleForm>
</core:FragmentDefinition>